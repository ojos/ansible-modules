---
- name: Install fabric.
  pip: >
    name=fabric
    state=present
  environment:
    PATH: "{{ fabric_python_bin_directory }}:{{ ansible_env.PATH }}"
  when: xbuild_python_version < 3
- name: Install fabric3.
  pip: >
    name=fabric3
    state=present
  environment:
    PATH: "{{ fabric_python_bin_directory }}:{{ ansible_env.PATH }}"
  when: xbuild_python_version >= 3

- name: Copy fabfile.py.
  copy: >
    src=fabfile.py
    dest={{ fabric_tasks_file_directory }}/fabfile.py
    mode=0644
    force=yes
  become: yes

- name: Change fabfile.py owner.
  file: >
    path="{{ fabric_tasks_file_directory }}/fabfile.py"
    state=file
    owner={{ fabric_user }}
    group={{ fabric_group }}
  become: yes